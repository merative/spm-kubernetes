{"componentChunkName":"component---src-pages-deploy-spm-build-spm-mdx","path":"/deploy-spm/build-spm/","result":{"pageContext":{"frontmatter":{"title":"Building the SPM application","description":"Building the SPM application"},"relativePagePath":"/deploy-spm/build-spm.mdx","titleType":"page","MdxNode":{"id":"55b399c0-6466-586f-99f0-ca9e3279019b","children":[],"parent":"ea4d2621-c052-5c6d-b4a9-513911663e55","internal":{"content":"---\ntitle: Building the SPM application\ndescription: Building the SPM application\n---\n\n<InlineNotification>\n\n**Note:** Before proceeding with the following steps, ensure that the steps defined in [Create the SPM Database](/deploy-spm/create_spm_db) are completed. This action should be only a one-off set-up.\n\n</InlineNotification>\n\nBuilding Merative Social Program Management (SPM) for deployment to Kubernetes is similar to on-premises SPM builds with some differences.\nNotably, because the application server for the cloud environment is IBM® WebSphere® Liberty some target names are changed or are not supported.\n\nTake the following steps to build SPM:\n\n## Source the SPM environment variables\n\nEnter the directory where SPM is installed and source the SetEnvironment script; for example:\n\n<Tabs>\n\n<Tab label=\"Mac/Linux\">\n<Row>\n<Column>\n\n```shell\ncd /opt/IBM/Curam/Development\n. SetEnvironment.sh\n```\n\n</Column>\n</Row>\n</Tab>\n\n<Tab label=\"Windows DOS\">\n<Row>\n<Column>\n\n```bat\ncd c:\\IBM\\Curam\\Development\nSetEnvironment.bat\n```\n\n</Column>\n</Row>\n</Tab>\n\n</Tabs>\n\n## Set up AppServer.properties and verify the configuration\n\nBefore you build SPM, add an `AppServer.properties` file to `$SERVER_DIR/project/properties`.  `AppServer.properties` must specify `as.vendor=WLP`; for example:\n\n```properties\n# Property to indicate that WebSphere Liberty is installed\nas.vendor=WLP\n\n# The username and password for the administrator role\nsecurity.username=websphere\n# Encrypt the plain-text password using 'build encrypt -Dpassword=<password>'\n# The encryption for the default password (\"websphere\") is as follows:\nsecurity.password=websphere\n\n# The name of the server on which the application will be hosted\ncuram.server.name=CuramServer\nserver.name=CuramServer\n\n# The Curam client HTTP port\ncuram.client.httpport=10101\n\n# The Curam web service port\ncuram.webservices.httpport=10102\n\n# Required for Building CuramBIRTViewer.ear\ncuram.server.port=2809\n```\n\nTo confirm your configuration, run the `configtest` Ant target using the following commands:\n\n<Tabs>\n\n<Tab label=\"Mac/Linux\">\n<Row>\n<Column>\n\n```shell\ncd $SERVER_DIR\n./build.sh configtest\n```\n\n</Column>\n</Row>\n</Tab>\n\n<Tab label=\"Windows DOS\">\n<Row>\n<Column>\n\n```bat\ncd %SERVER_DIR%\nbuild.bat configtest\n```\n\n</Column>\n</Row>\n</Tab>\n\n</Tabs>\n\n<InlineNotification>\n\n**Note:** When running the `configtest` Ant target you may experience a failed build with an `Unsupported version:` error in relation to the WebSphere Liberty version.\n\nIf this happens please refer to the [Prerequisite software](https://merative.github.io/spm-kubernetes/prereq/prereq/) for the correct list of supported WebSphere Liberty versions.\n\n</InlineNotification>\n\n## Set up static content\n\nThe static content server feature allows static content to be hosted on a separate web server.\nThis feature allows the web server that hosts the static content to be tuned for the static content and reduces the load on the main SPM application servers.\nThe option enables the relocation of static content to a separate server to allow for performance optimizations.\n\nTo enable static content, create a file called `curam-config.xml` in the following location `$CLIENT_DIR/components/custom/`.\n\nAdd the following to `curam-config.xml`:\n\n<InlineNotification>\n\n**Note:** The guidelines assume that the relative URL `/CuramStatic/` is being used.\n\n</InlineNotification>\n\n```xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<APP_CONFIG>\n  <STATIC_CONTENT_SERVER>\n    <URL>/CuramStatic/</URL>\n  </STATIC_CONTENT_SERVER>\n</APP_CONFIG>\n```\n\n<InlineNotification>\n\n**Note:** For more information about SPM static content, see **Static Content Server** in the *Social Program Management Web Client Reference Manual*.\n\n</InlineNotification>\n\n## Build the SPM server\n\nTo build the SPM server, run the following command:\n\n<Tabs>\n\n<Tab label=\"Mac/Linux\">\n<Row>\n<Column>\n\n```shell\n./build.sh clean server\n```\n\n</Column>\n</Row>\n</Tab>\n\n<Tab label=\"Windows DOS\">\n<Row>\n<Column>\n\n```bat\nbuild.bat clean server\n```\n\n</Column>\n</Row>\n</Tab>\n\n</Tabs>\n\n## Build the database\n\nTo build the SPM database, run the following command:\n\n<Tabs>\n\n<Tab label=\"Mac/Linux\">\n<Row>\n<Column>\n\n```shell\n./build.sh database prepare.application.data\n```\n\n</Column>\n</Row>\n</Tab>\n\n<Tab label=\"Windows DOS\">\n<Row>\n<Column>\n\n```bat\nbuild.bat database prepare.application.data\n```\n\n</Column>\n</Row>\n</Tab>\n\n</Tabs>\n\n## Build the SPM client\n\nTo build the SPM client, run the following commands:\n\n<Tabs>\n\n<Tab label=\"Mac/Linux\">\n<Row>\n<Column>\n\n```shell\ncd $CLIENT_DIR\n./build.sh clean client\n```\n\n</Column>\n</Row>\n</Tab>\n\n<Tab label=\"Windows DOS\">\n<Row>\n<Column>\n\n```bat\ncd %CLIENT_DIR%\nbuild.bat clean client\n```\n\n</Column>\n</Row>\n</Tab>\n\n</Tabs>\n\n## Build `StaticContent.zip`\n\nTo build SPM `StaticContent.zip`, run the following commands:\n\n<Tabs>\n\n<Tab label=\"Mac/Linux\">\n<Row>\n<Column>\n\n```shell\ncd $CLIENT_DIR\n./build.sh zip-static-content\n```\n\n</Column>\n</Row>\n</Tab>\n\n<Tab label=\"Windows\">\n<Row>\n<Column>\n\n```bat\ncd %CLIENT_DIR%\nbuild.bat zip-static-content\n```\n\n</Column>\n</Row>\n</Tab>\n\n</Tabs>\n\nThe `StaticContent.zip` file that is created is in the `$CLIENT_DIR/build` folder and is needed for the steps in\n[Setting up the Docker® context](/build-images/setup_docker_context).\n\n## Build the Cúram EAR files for WebSphere Liberty\n\nModify the `requireServer` setting in the `$SERVER_DIR/project/config/deployment_packaging.xml` file. This command works on multiple platforms:\n\n```shell\nsed -i 's/name=\"Curam\" requireServer=\"true\"/name=\"Curam\" requireServer=\"false\"/g' \\\n    $SERVER_DIR/project/config/deployment_packaging.xml\n```\n\nTo build the application EAR files for WebSphere Liberty, run the following commands:\n\n<Tabs>\n\n<Tab label=\"Mac/Linux\">\n<Row>\n<Column>\n\n```shell\ncd $SERVER_DIR\n./build.sh libertyEAR -Dcuram.ejbserver.app.name=CuramServerCode\n./build.sh libertyEAR -Dserver.only=true \\\n                      -Dear.name=CuramServerCode \\\n                      -DSERVER_MODEL_NAME=CuramServerCode \\\n                      -Dcuram.ejbserver.app.name=CuramServerCode\n```\n\n</Column>\n</Row>\n</Tab>\n\n<Tab label=\"Windows DOS\">\n<Row>\n<Column>\n\n```bat\ncd %SERVER_DIR%\nbuild.bat libertyEAR -Dcuram.ejbserver.app.name=CuramServerCode\nbuild.bat libertyEAR -Dserver.only=true ^\n                      -Dear.name=CuramServerCode ^\n                      -DSERVER_MODEL_NAME=CuramServerCode ^\n                      -Dcuram.ejbserver.app.name=CuramServerCode\n```\n\n</Column>\n</Row>\n</Tab>\n\n</Tabs>\n\n### Precompiling JSPs\n\nTo improve initial page load performance, use the `precompile` target to precompile the JSPs in an application EAR file before deployment. Run the following target for each EAR file.\n\n<InlineNotification>\n\n**Note:**  The precompile target can take up to several hours to complete. Ensure that your environment is not significantly restricted regarding available CPU, memory, and free space in the `$CURAMSDEJ` file system.\n\n**Note:** It is not required to run the `precompile` target on the `CuramServerCode.ear`, `CuramWebServices.ear` or `Rest.ear`.\n\n</InlineNotification>\n\n<Tabs>\n\n<Tab label=\"Mac/Linux\">\n<Row>\n<Column>\n\n```shell\n./build.sh precompilejsp -Dear.file=$SERVER_DIR/build/ear/WLP/Curam.ear\n```\n\n</Column>\n</Row>\n</Tab>\n\n<Tab label=\"Windows DOS\">\n<Row>\n<Column>\n\n```bat\nbuild.bat precompilejsp -Dear.file=%SERVER_DIR%\\build\\ear\\WLP\\Curam.ear\n```\n\n</Column>\n</Row>\n</Tab>\n\n</Tabs>\n\n## Package an SPM release.zip file\n\nTo package the build into a `release.zip` file, run the following command:\n\n<Tabs>\n\n<Tab label=\"Mac/Linux\">\n<Row>\n<Column>\n\n```shell\n./build.sh release -Dcreate.zip=true\n```\n\n</Column>\n</Row>\n</Tab>\n\n<Tab label=\"Windows DOS\">\n<Row>\n<Column>\n\n```bat\nbuild.bat release -Dcreate.zip=true\n```\n\n</Column>\n</Row>\n</Tab>\n\n</Tabs>\n\nThe .zip file that is created is in the `$SERVER_DIR/release` folder and is needed for the steps in\n[Setting up the Docker environment](/build-images/setup_docker_context).\n\n<InlineNotification>\n\n**Note:** Check the zip file in later stages to ensure that its integrity or size are unchanged when copying to different directories or machines.\n\nOn OSX and Red Hat, a zip file ends with `.zip` and looks like a white file.\n\nOn Windows, a zip file ends with `.zip` and looks like a folder.\n\n</InlineNotification>\n","type":"Mdx","contentDigest":"e6acd387141f9f9839d4f5744cda1e03","owner":"gatsby-plugin-mdx","counter":167},"frontmatter":{"title":"Building the SPM application","description":"Building the SPM application"},"exports":{},"rawBody":"---\ntitle: Building the SPM application\ndescription: Building the SPM application\n---\n\n<InlineNotification>\n\n**Note:** Before proceeding with the following steps, ensure that the steps defined in [Create the SPM Database](/deploy-spm/create_spm_db) are completed. This action should be only a one-off set-up.\n\n</InlineNotification>\n\nBuilding Merative Social Program Management (SPM) for deployment to Kubernetes is similar to on-premises SPM builds with some differences.\nNotably, because the application server for the cloud environment is IBM® WebSphere® Liberty some target names are changed or are not supported.\n\nTake the following steps to build SPM:\n\n## Source the SPM environment variables\n\nEnter the directory where SPM is installed and source the SetEnvironment script; for example:\n\n<Tabs>\n\n<Tab label=\"Mac/Linux\">\n<Row>\n<Column>\n\n```shell\ncd /opt/IBM/Curam/Development\n. SetEnvironment.sh\n```\n\n</Column>\n</Row>\n</Tab>\n\n<Tab label=\"Windows DOS\">\n<Row>\n<Column>\n\n```bat\ncd c:\\IBM\\Curam\\Development\nSetEnvironment.bat\n```\n\n</Column>\n</Row>\n</Tab>\n\n</Tabs>\n\n## Set up AppServer.properties and verify the configuration\n\nBefore you build SPM, add an `AppServer.properties` file to `$SERVER_DIR/project/properties`.  `AppServer.properties` must specify `as.vendor=WLP`; for example:\n\n```properties\n# Property to indicate that WebSphere Liberty is installed\nas.vendor=WLP\n\n# The username and password for the administrator role\nsecurity.username=websphere\n# Encrypt the plain-text password using 'build encrypt -Dpassword=<password>'\n# The encryption for the default password (\"websphere\") is as follows:\nsecurity.password=websphere\n\n# The name of the server on which the application will be hosted\ncuram.server.name=CuramServer\nserver.name=CuramServer\n\n# The Curam client HTTP port\ncuram.client.httpport=10101\n\n# The Curam web service port\ncuram.webservices.httpport=10102\n\n# Required for Building CuramBIRTViewer.ear\ncuram.server.port=2809\n```\n\nTo confirm your configuration, run the `configtest` Ant target using the following commands:\n\n<Tabs>\n\n<Tab label=\"Mac/Linux\">\n<Row>\n<Column>\n\n```shell\ncd $SERVER_DIR\n./build.sh configtest\n```\n\n</Column>\n</Row>\n</Tab>\n\n<Tab label=\"Windows DOS\">\n<Row>\n<Column>\n\n```bat\ncd %SERVER_DIR%\nbuild.bat configtest\n```\n\n</Column>\n</Row>\n</Tab>\n\n</Tabs>\n\n<InlineNotification>\n\n**Note:** When running the `configtest` Ant target you may experience a failed build with an `Unsupported version:` error in relation to the WebSphere Liberty version.\n\nIf this happens please refer to the [Prerequisite software](https://merative.github.io/spm-kubernetes/prereq/prereq/) for the correct list of supported WebSphere Liberty versions.\n\n</InlineNotification>\n\n## Set up static content\n\nThe static content server feature allows static content to be hosted on a separate web server.\nThis feature allows the web server that hosts the static content to be tuned for the static content and reduces the load on the main SPM application servers.\nThe option enables the relocation of static content to a separate server to allow for performance optimizations.\n\nTo enable static content, create a file called `curam-config.xml` in the following location `$CLIENT_DIR/components/custom/`.\n\nAdd the following to `curam-config.xml`:\n\n<InlineNotification>\n\n**Note:** The guidelines assume that the relative URL `/CuramStatic/` is being used.\n\n</InlineNotification>\n\n```xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<APP_CONFIG>\n  <STATIC_CONTENT_SERVER>\n    <URL>/CuramStatic/</URL>\n  </STATIC_CONTENT_SERVER>\n</APP_CONFIG>\n```\n\n<InlineNotification>\n\n**Note:** For more information about SPM static content, see **Static Content Server** in the *Social Program Management Web Client Reference Manual*.\n\n</InlineNotification>\n\n## Build the SPM server\n\nTo build the SPM server, run the following command:\n\n<Tabs>\n\n<Tab label=\"Mac/Linux\">\n<Row>\n<Column>\n\n```shell\n./build.sh clean server\n```\n\n</Column>\n</Row>\n</Tab>\n\n<Tab label=\"Windows DOS\">\n<Row>\n<Column>\n\n```bat\nbuild.bat clean server\n```\n\n</Column>\n</Row>\n</Tab>\n\n</Tabs>\n\n## Build the database\n\nTo build the SPM database, run the following command:\n\n<Tabs>\n\n<Tab label=\"Mac/Linux\">\n<Row>\n<Column>\n\n```shell\n./build.sh database prepare.application.data\n```\n\n</Column>\n</Row>\n</Tab>\n\n<Tab label=\"Windows DOS\">\n<Row>\n<Column>\n\n```bat\nbuild.bat database prepare.application.data\n```\n\n</Column>\n</Row>\n</Tab>\n\n</Tabs>\n\n## Build the SPM client\n\nTo build the SPM client, run the following commands:\n\n<Tabs>\n\n<Tab label=\"Mac/Linux\">\n<Row>\n<Column>\n\n```shell\ncd $CLIENT_DIR\n./build.sh clean client\n```\n\n</Column>\n</Row>\n</Tab>\n\n<Tab label=\"Windows DOS\">\n<Row>\n<Column>\n\n```bat\ncd %CLIENT_DIR%\nbuild.bat clean client\n```\n\n</Column>\n</Row>\n</Tab>\n\n</Tabs>\n\n## Build `StaticContent.zip`\n\nTo build SPM `StaticContent.zip`, run the following commands:\n\n<Tabs>\n\n<Tab label=\"Mac/Linux\">\n<Row>\n<Column>\n\n```shell\ncd $CLIENT_DIR\n./build.sh zip-static-content\n```\n\n</Column>\n</Row>\n</Tab>\n\n<Tab label=\"Windows\">\n<Row>\n<Column>\n\n```bat\ncd %CLIENT_DIR%\nbuild.bat zip-static-content\n```\n\n</Column>\n</Row>\n</Tab>\n\n</Tabs>\n\nThe `StaticContent.zip` file that is created is in the `$CLIENT_DIR/build` folder and is needed for the steps in\n[Setting up the Docker® context](/build-images/setup_docker_context).\n\n## Build the Cúram EAR files for WebSphere Liberty\n\nModify the `requireServer` setting in the `$SERVER_DIR/project/config/deployment_packaging.xml` file. This command works on multiple platforms:\n\n```shell\nsed -i 's/name=\"Curam\" requireServer=\"true\"/name=\"Curam\" requireServer=\"false\"/g' \\\n    $SERVER_DIR/project/config/deployment_packaging.xml\n```\n\nTo build the application EAR files for WebSphere Liberty, run the following commands:\n\n<Tabs>\n\n<Tab label=\"Mac/Linux\">\n<Row>\n<Column>\n\n```shell\ncd $SERVER_DIR\n./build.sh libertyEAR -Dcuram.ejbserver.app.name=CuramServerCode\n./build.sh libertyEAR -Dserver.only=true \\\n                      -Dear.name=CuramServerCode \\\n                      -DSERVER_MODEL_NAME=CuramServerCode \\\n                      -Dcuram.ejbserver.app.name=CuramServerCode\n```\n\n</Column>\n</Row>\n</Tab>\n\n<Tab label=\"Windows DOS\">\n<Row>\n<Column>\n\n```bat\ncd %SERVER_DIR%\nbuild.bat libertyEAR -Dcuram.ejbserver.app.name=CuramServerCode\nbuild.bat libertyEAR -Dserver.only=true ^\n                      -Dear.name=CuramServerCode ^\n                      -DSERVER_MODEL_NAME=CuramServerCode ^\n                      -Dcuram.ejbserver.app.name=CuramServerCode\n```\n\n</Column>\n</Row>\n</Tab>\n\n</Tabs>\n\n### Precompiling JSPs\n\nTo improve initial page load performance, use the `precompile` target to precompile the JSPs in an application EAR file before deployment. Run the following target for each EAR file.\n\n<InlineNotification>\n\n**Note:**  The precompile target can take up to several hours to complete. Ensure that your environment is not significantly restricted regarding available CPU, memory, and free space in the `$CURAMSDEJ` file system.\n\n**Note:** It is not required to run the `precompile` target on the `CuramServerCode.ear`, `CuramWebServices.ear` or `Rest.ear`.\n\n</InlineNotification>\n\n<Tabs>\n\n<Tab label=\"Mac/Linux\">\n<Row>\n<Column>\n\n```shell\n./build.sh precompilejsp -Dear.file=$SERVER_DIR/build/ear/WLP/Curam.ear\n```\n\n</Column>\n</Row>\n</Tab>\n\n<Tab label=\"Windows DOS\">\n<Row>\n<Column>\n\n```bat\nbuild.bat precompilejsp -Dear.file=%SERVER_DIR%\\build\\ear\\WLP\\Curam.ear\n```\n\n</Column>\n</Row>\n</Tab>\n\n</Tabs>\n\n## Package an SPM release.zip file\n\nTo package the build into a `release.zip` file, run the following command:\n\n<Tabs>\n\n<Tab label=\"Mac/Linux\">\n<Row>\n<Column>\n\n```shell\n./build.sh release -Dcreate.zip=true\n```\n\n</Column>\n</Row>\n</Tab>\n\n<Tab label=\"Windows DOS\">\n<Row>\n<Column>\n\n```bat\nbuild.bat release -Dcreate.zip=true\n```\n\n</Column>\n</Row>\n</Tab>\n\n</Tabs>\n\nThe .zip file that is created is in the `$SERVER_DIR/release` folder and is needed for the steps in\n[Setting up the Docker environment](/build-images/setup_docker_context).\n\n<InlineNotification>\n\n**Note:** Check the zip file in later stages to ensure that its integrity or size are unchanged when copying to different directories or machines.\n\nOn OSX and Red Hat, a zip file ends with `.zip` and looks like a white file.\n\nOn Windows, a zip file ends with `.zip` and looks like a folder.\n\n</InlineNotification>\n","fileAbsolutePath":"/home/runner/work/spm-kubernetes/spm-kubernetes/src/pages/deploy-spm/build-spm.mdx"}}},"staticQueryHashes":["1364590287","137577622","2102389209","2456312558","2746626797","3018647132","3037994772","56986546","768070550"]}