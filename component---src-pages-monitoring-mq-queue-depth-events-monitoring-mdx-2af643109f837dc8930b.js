"use strict";(self.webpackChunkspm_kubernetes=self.webpackChunkspm_kubernetes||[]).push([[5971],{2573:function(e,t,n){n.r(t),n.d(t,{_frontmatter:function(){return s},default:function(){return m}});var i=n(45),a=(n(6540),n(5680)),o=n(4330);const r=["components"],s={},l={_frontmatter:s},u=o.A;function m(e){let{components:t}=e,n=(0,i.A)(e,r);return(0,a.yg)(u,Object.assign({},l,n,{components:t,mdxType:"MDXLayout"}),(0,a.yg)("h2",null,"What are MQ Queue Depth Events?"),(0,a.yg)("p",null,"A wide variety of metrics for the IBM MQ queue manager exist such as documented in the\n",(0,a.yg)("a",{parentName:"p",href:"https://www.ibm.com/docs/en/ibm-mq/9.2?topic=operator-metrics-published-when-using-mq"},"IBM Documentation"),".\nHowever, these metrics do not currently cover the queue or the topic level attributes such as\nthe queue depth, that is the number of messages on the queue.\nThis data are valuable for more successful monitoring."),(0,a.yg)("h2",null,"Enabling monitoring"),(0,a.yg)("p",null,"To operate correctly, the queues must not become full as, if they do, the applications can no longer\nput messages on the queue that they specify. Although the message is not\nlost if this occurs, a full queue can cause considerable inconvenience.\nWith IBM MQ Prometheus monitor, a wide variety of statistics\nabout that queue manager are published."),(0,a.yg)("p",null,"The following information describes how to enable Prometheus monitoring agent that connects to an IBM MQ server.\nThis monitor is based on the open-source project ",(0,a.yg)("a",{parentName:"p",href:"https://github.com/ibm-messaging/mq-metric-samples"},"MQ Metrics Sample"),"\nwhich provides the monitor ",(0,a.yg)("inlineCode",{parentName:"p"},"mq_prometheus")," to be compiled and the image ",(0,a.yg)("inlineCode",{parentName:"p"},"mq-metric-prometheus")," to be built."),(0,a.yg)("p",null,"Together, they will expose metrics about the following queue depth events\nwhich permit to understand what is happening in the queues:"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"Queue Depth High events"),"\nIndicate that the queue depth has increased to a predefined threshold\ncalled the Queue Depth High limit."),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"Queue Depth Low events"),"\nIndicate that the queue depth has decreased to a predefined threshold\ncalled the Queue Depth Low limit."),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"Queue Full events"),"\nIndicate that the queue has reached its maximum depth, that is, the queue\nis full.")),(0,a.yg)("p",null,"More details are available in the\n",(0,a.yg)("a",{parentName:"p",href:"https://www.ibm.com/docs/en/ibm-mq/9.2?topic=events-enabling-queue-depth"},"IBM MQ Queue Depth Events"),"\ndocumentation."),(0,a.yg)("h2",null,"Building MQ Metric Pod"),(0,a.yg)("p",null,"The following commands show how to build the MQ Metrics Pod which contains the monitor ",(0,a.yg)("inlineCode",{parentName:"p"},"mq_prometheus"),"."),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre"},'# Clone repository locally\ngit clone https://github.com/ibm-messaging/mq-metric-samples.git\n\n# Build code and image\ncd mq-metric-samples/scripts\n./buildRuntime.sh mq_prometheus\n\n# Retrieve current latest image tag\nDIST_TAG_LATEST=`git tag -l | sort | tail -1 | sed "s/^v//g"`\necho "The current latest image tag is: $DIST_TAG_LATEST"\n\n# Show built image(s)\ndocker images\n')),(0,a.yg)("h2",null,"Pushing Image"),(0,a.yg)("p",null,"The following commands are illustrating how to tag and push the MQ Metric Pod to a typical Container Registry."),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre"},"# Tagging image\ndocker tag mq-metric-prometheus:$DIST_TAG_LATEST ${server-name}.jfrog.io/{repo-name}/mq-metric-prometheus:$DIST_TAG_LATEST\n\n\n# Push images to registry\ndocker push --all-tags ${server-name}.jfrog.io/{repo-name}/mq-metric-prometheus:$DIST_TAG_LATEST\n\n")),(0,a.yg)("h2",null,"Deploy"),(0,a.yg)("p",null,"To enable the deployment of the MQ Metric Pod, the values ",(0,a.yg)("inlineCode",{parentName:"p"},"global.mq.metrics.enabled")," and\n",(0,a.yg)("inlineCode",{parentName:"p"},"global.mq.metrics.additionalMetrics")," are required to be toggled to ",(0,a.yg)("inlineCode",{parentName:"p"},"true"),"."),(0,a.yg)("p",null,"Additionally, the values ",(0,a.yg)("inlineCode",{parentName:"p"},"mqserver.metricsImage.library"),", ",(0,a.yg)("inlineCode",{parentName:"p"},"mqserver.metricsImage.name"),", and ",(0,a.yg)("inlineCode",{parentName:"p"},"mqserver.metricsImage.tag"),"\nare required to be set with the details of the image registry containing your IBM MQ Queue Depth Events image."),(0,a.yg)("p",null,"More details about the configuration values are provided in the\n",(0,a.yg)("a",{parentName:"p",href:"/spm-kubernetes/deployment/config-reference"},"Configuration Reference"),"\nunder the ",(0,a.yg)("a",{parentName:"p",href:"/spm-kubernetes/deployment/config-reference#mq-metrics-(optional)"},"MQ Metrics")," topic."))}m.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-monitoring-mq-queue-depth-events-monitoring-mdx-2af643109f837dc8930b.js.map